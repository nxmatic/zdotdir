setopt local_options

local 0=${(%):-%x}
local _cmd=${1:-on}
local _dir="$(realpath ${2:-${0:h}/..})"
local _paths=( ${_dir}/**/*(.N) )
local _functions=( ${(q)_paths[@]:t} )

case ${_cmd} in
  on)
    autoload -t ${_functions}
    ;;
  off)
    autoload +t ${_functions}
    ;;
esac
