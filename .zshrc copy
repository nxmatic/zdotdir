#!/bin/zsh
#
# .zshrc - Run on interactive Zsh session.
#

# load zprof first if we need to profile
[[ ${ZPROFRC:-0} -eq 0 ]] || zmodload zsh/zprof
alias zprofrc="ZPROFRC=1 zsh"
alias zbench='for i in {1..10}; do /usr/bin/time zsh -lic exit; done'

# Load zfunctions.
fpath=($ZDOTDIR/functions $fpath)
autoload -Uz $fpath[1]/*(.:t)

# zsh plugins
myplugins=(
  # Load customizations.
  $ZDOTDIR/.zstyles

  # zephyr
  mattmc3/zephyr/plugins/zfunctions
  mattmc3/zephyr/plugins/clipboard
  mattmc3/zephyr/plugins/color
  mattmc3/zephyr/plugins/environment
  mattmc3/zephyr/plugins/terminal
  mattmc3/zephyr/plugins/editor
  mattmc3/zephyr/plugins/history
  mattmc3/zephyr/plugins/directory
  mattmc3/zephyr/plugins/homebrew
  mattmc3/zephyr/plugins/macos

  # regular plugins
  mattmc3/zman
  rupa/z

  # oh-my-zsh plugins
  ohmyzsh/ohmyzsh/plugins/magic-enter
  ohmyzsh/ohmyzsh/plugins/fancy-ctrl-z

  # local plugins
  python

  # prompt
  sindresorhus/pure
  #starship
  #spaceship-prompt/spaceship-prompt
  #romkatv/powerlevel10k
  #p10k

  # last
  #mattmc3/zephyr/plugins/confd
  $ZDOTDIR/.zaliases

  # completions
  zsh-users/zsh-completions
  mattmc3/zephyr/plugins/completion

  # deferred
  romkatv/zsh-defer
  olets/zsh-abbr
  zdharma-continuum/fast-syntax-highlighting
  #zsh-users/zsh-syntax-highlighting
  zsh-users/zsh-autosuggestions
  zsh-users/zsh-history-substring-search
)

# get minmalist zsh_unplugged plugin manager
ZUNPLUG_REPOS=$ZDOTDIR/plugins/.external
source $ZDOTDIR/lib/unplugged.zsh
source $ZDOTDIR/.zplugins

# utility plugins
path+=$ZUNPLUG_REPOS/zsh-bench

# Done profiling.
[[ ${ZPROFRC:-0} -eq 0 ]] || { unset ZPROFRC && zprof }
